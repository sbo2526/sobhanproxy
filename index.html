<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>سبحان پروکسی</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
  <style>
    body { background-color: #f5f5f5; padding-top: 80px; }
    .card { border-radius: 1rem; box-shadow: 0 2px 10px rgba(0,0,0,0.1); transition: transform 0.2s ease; }
    .card:hover { transform: translateY(-3px); }
    .navbar { box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
    .proxy-box { padding: 20px; }
    .dropdown-menu {
      width: auto !important; min-width: auto !important;
      max-width: 90vw; white-space: nowrap;
      overflow-x: hidden; text-align: right;
      font-size: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      border-radius: 0.5rem;
    }
  </style>
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top">
  <div class="container d-flex justify-content-between align-items-center">
    <a class="navbar-brand fw-bold" href="#">سبحان پروکسی</a>
    <div class="dropdown">
      <button class="btn btn-outline-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown">
        منو
      </button>
      <ul class="dropdown-menu dropdown-menu-end text-end">
  <li><a class="dropdown-item" href="#" onclick="showMain()">🏠 صفحه اصلی</a></li>
  <li><a class="dropdown-item" href="#" onclick="showAbout()">ℹ️ درباره ما</a></li>
  <li><a class="dropdown-item" href="#" onclick="showContact()">📬 ارتباط با ما</a></li>
  <li>
    <a class="dropdown-item" href="https://play.google.com/store/apps/details?id=com.sobhan.proxy" target="_blank">
      🤖 دانلود نسخه اندروید
    </a>
  </li>
  <li><a class="dropdown-item" href="tg://resolve?domain=sobhanproxy">📢 کانال تلگرام</a></li>
</ul>
    </div>
  </div>
</nav>
<style>
.rtl-content {
  direction: rtl !important;
  text-align: right !important;
}
</style>

<div id="aboutSection" class="container rtl-content" style="display: none;">
  <div class="py-4">
    <h3 class="fw-bold mb-4">🌟 درباره ما</h3>

    <p class="fs-6">
      برنامه «<strong>سبحان پروکسی</strong>» با هدف ساده‌سازی دسترسی به اینترنت آزاد و تجربه‌ای بهتر از استفاده از پیام‌رسان تلگرام، به صورت کاملاً رایگان و با عشق و تلاش فردی طراحی و توسعه داده شده است.
    </p>

    <p class="fs-6 mt-3">
      این اپلیکیشن توسط یک برنامه‌نویس مستقل و بدون حمایت مالی از هیچ سازمان یا نهاد خاصی ساخته شده است.
    </p>

    <h5 class="fw-semibold mt-4 mb-3">✅ ویژگی‌های کلیدی:</h5>
    <ul class="fs-6">
      <li>دریافت پروکسی‌های به‌روز از منابع مختلف</li>
      <li>تست و نمایش پینگ واقعی هر پروکسی</li>
      <li>مرتب‌سازی بر اساس سرعت و کیفیت اتصال</li>
      <li>اتصال آسان به تلگرام فقط با یک کلیک</li>
      <li>طراحی مدرن، سبک و بهینه‌شده برای گوشی‌های اندرویدی</li>
    </ul>

    <h5 class="fw-semibold mt-4 mb-2">🤝 حمایت از توسعه‌دهنده:</h5>
    <p class="fs-6">
      اگر این برنامه برای شما مفید بوده، می‌توانید از ما حمایت کنید:
      <br>
      • معرفی برنامه به دوستان<br>
      • ارائه بازخورد و پیشنهاد<br>
      • حمایت مالی در آینده (در صورت افزودن قابلیت)
    </p>

    <p class="fs-6 mt-4">
      📬 تماس با ما: از طریق بخش «ارتباط با ما» در برنامه.
    </p>

    <p class="fs-6 fw-medium mt-5">
      با احترام،<br>
      توسعه‌دهنده‌ی مستقل برنامه پروکسی تلگرام 🌐
    </p>
  </div>
</div>

<div id="contactSection" class="container rtl-content" style="display: none;">
  <div class="py-4">
    <h3 class="fw-bold mb-4">📬 ارتباط با ما</h3>

    <p class="fs-6">
      خوشحال می‌شویم نظرات، پیشنهادات یا مشکلات خود را با ما در میان بگذارید. پاسخ‌گویی ما معمولاً در کمتر از ۲۴ ساعت انجام می‌شود.
    </p>

    <h5 class="fw-semibold mt-4 mb-3">📱 روش‌های ارتباطی:</h5>
    <ul class="fs-6">
      <li>💬 آیدی تلگرام: <strong>@sobhanproxy</strong></li>
      <li>📢 کانال اطلاع‌رسانی: 
        <a href="https://t.me/sobhanproxy" class="text-decoration-none" target="_blank">@sobhanproxy</a>
      </li>
      <li>📨 ارسال پیام مستقیم: 
        <a href="tg://resolve?domain=sobhanproxy" class="btn btn-outline-success btn-sm ms-2">ارسال در تلگرام</a>
      </li>
    </ul>

    <h5 class="fw-semibold mt-4 mb-2">❓ چرا با ما تماس بگیرید؟</h5>
    <p class="fs-6">
      • برای ارسال پیشنهاد یا انتقاد<br>
      • گزارش خطاها و مشکلات برنامه<br>
      • درخواست قابلیت جدید یا همکاری
    </p>

    <p class="fs-6 mt-4">
      ما همیشه گوش‌به‌زنگ هستیم 🌟
    </p>

    <p class="fs-6 fw-medium mt-5">
      با سپاس فراوان،<br>
      تیم پشتیبانی سبحان پروکسی
    </p>
  </div>
    <h3 class="fw-bold mb-4">📬 ارتباط با ما</h3>

    <p style="font-size: 16px;">
      خوشحال می‌شویم نظرات، پیشنهادات یا مشکلات خود را با ما در میان بگذارید. پاسخ‌گویی ما معمولاً در کمتر از ۲۴ ساعت انجام می‌شود.
    </p>

    <h5 class="fw-semibold mb-3">📱 روش‌های ارتباطی:</h5>
    <ul style="font-size: 16px;">
      <li>💬 آیدی تلگرام: <strong>@sobhanproxy</strong></li>
      <li>📢 کانال اطلاع‌رسانی: 
        <a href="https://t.me/sobhanproxy" class="text-decoration-none" target="_blank">@sobhanproxy</a>
      </li>
      <li>📨 ارسال پیام مستقیم: 
        <a href="tg://resolve?domain=sobhanproxy" class="btn btn-outline-success btn-sm ms-2">ارسال در تلگرام</a>
      </li>
    </ul>

    <h5 class="fw-semibold mt-4 mb-2">❓ چرا با ما تماس بگیرید؟</h5>
    <p style="font-size: 16px;">
      • برای ارسال پیشنهاد یا انتقاد<br>
      • گزارش خطاها و مشکلات برنامه<br>
      • درخواست قابلیت جدید یا همکاری
    </p>

    <p class="mt-4" style="font-size: 16px;">
      ما همیشه گوش‌به‌زنگ هستیم 🌟
    </p>

    <p class="mt-5" style="font-size: 16px; font-weight: 500;">
      با سپاس فراوان،<br>
      تیم پشتیبانی سبحان پروکسی
    </p>
  </div>
</div>



<!-- محتوای اصلی -->
<div class="container" id="mainContent">
  <h2 class="text-center mb-4">🌐 لیست پروکسی‌های تلگرام</h2>
  <div class="mb-4 text-center">
    <input type="text" id="searchBox" class="form-control w-50 d-inline" placeholder="جستجوی سرور مثلاً: ۱ یا 2">
  </div>
  <div id="proxy-list" class="row justify-content-center">
    <p class="text-center text-muted">
      <div class="spinner-border text-primary" role="status"><span class="visually-hidden">در حال دریافت...</span></div>
    </p>
  </div>
</div>

<!-- Modal اطلاعیه -->
<div class="modal fade" id="welcomeModal" tabindex="-1" aria-labelledby="welcomeModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content" dir="rtl" style="text-align: right;">
      <div class="modal-header">
        <h5 class="modal-title" id="welcomeModalLabel">🔔 اطلاعیه مهم</h5>
        <button type="button" class="btn-close ms-auto" data-bs-dismiss="modal" aria-label="بستن"></button>
      </div>
      <div class="modal-body" style="font-family: 'Vazir', sans-serif; line-height: 1.8;">
        <p>این برنامه <strong>کاملاً رایگان</strong> است و توسط یک فرد مستقل ساخته شده و همیشه نیز رایگان باقی خواهد ماند.</p>
        <p>تنها خواهش ما این است که برای حمایت از ما، عضو کانال تلگرام ما شوید 🙏</p>
        <p class="text-center mt-4">
          <a href="https://t.me/sobhanproxy" target="_blank" class="btn btn-outline-primary">📢 عضویت در کانال</a>
        </p>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
  window.addEventListener('load', () => {
    loadProxies();
    const modal = new bootstrap.Modal(document.getElementById('welcomeModal'));
    modal.show();
  });

  async function loadProxies() {
    const list = document.getElementById('proxy-list');
    try {
      const res = await fetch('https://raw.githubusercontent.com/sbo2526/dns-switcher/main/Proxy/proxies.json');
      const text = await res.text();

      if (text.startsWith('<!DOCTYPE html') || text.includes('<html')) {
        list.innerHTML = '<p class="text-danger text-center">❌ فایل JSON به درستی دریافت نشد (شاید GitHub محدود کرده)</p>';
        return;
      }

      const data = JSON.parse(text);
      const sorted = data.sort((a, b) => (parseInt(a.ping || 999) - parseInt(b.ping || 999)));
      list.innerHTML = '';

      let index = 0;
      sorted.forEach((proxy) => {
        if (!proxy.server || !proxy.port || !proxy.secret) return;

        const server = String(proxy.server).trim();
        const port = String(proxy.port).trim();
        const secret = String(proxy.secret).trim().toLowerCase();

        if (!/^ee[a-f0-9]{64,}$/i.test(secret)) return;

        const finalUrl = `tg://proxy?server=${server}&port=${port}&secret=${secret}`;
        index++;

        const card = document.createElement('div');
        card.className = 'col-md-4 col-sm-6 mb-4';
        card.innerHTML = `
  <div class="card h-100" data-index="${index}">
    <div class="card-body d-flex flex-column justify-content-between">
      <div class="proxy-box">
        <h5 class="mb-3 text-primary">سرور شماره ${index}</h5>
        <p class="mb-2">⏱️ پینگ: ${proxy.ping || 'نامشخص'}ms</p>
        <p class="mb-3 text-muted">🔒 MTProto</p>
      </div>
      <a href="${finalUrl}" class="btn btn-outline-primary mt-auto w-100" target="_blank">
        اتصال به تلگرام
      </a>
    </div>
  </div>
`;

        list.appendChild(card);
      });

      if (index === 0) {
        list.innerHTML = '<p class="text-warning text-center">⚠️ هیچ پروکسی MTProto معتبر یافت نشد.</p>';
      }
    } catch (err) {
      list.innerHTML = '<p class="text-danger text-center">❌ خطا در دریافت لیست پروکسی‌ها</p>';
    }
  }

  function hideAllSections() {
    document.getElementById('proxy-list').style.display = 'none';
    document.getElementById('aboutSection').style.display = 'none';
    document.getElementById('contactSection').style.display = 'none';
    document.getElementById('mainContent').style.display = 'none';
  }

  function showMain() {
    hideAllSections();
    document.getElementById('proxy-list').style.display = 'flex';
    document.getElementById('mainContent').style.display = 'block';
  }

  function showAbout() {
    hideAllSections();
    document.getElementById('aboutSection').style.display = 'block';
  }

  function showContact() {
    hideAllSections();
    document.getElementById('contactSection').style.display = 'block';
  }

  function rateApp() {
    const fallbackUrl = "https://play.google.com/store/apps/details?id=com.sobhan.proxy";
    window.location.href = "market://details?id=com.sobhan.proxy";
    setTimeout(() => {
      window.location.href = fallbackUrl;
    }, 1000);
  }

  document.getElementById('searchBox').addEventListener('input', function () {
    const searchTerm = this.value.trim().toLowerCase().replace('سرور', '').trim();
    const cards = document.querySelectorAll('#proxy-list .card');

    cards.forEach(card => {
      const index = card.getAttribute('data-index');
      if (searchTerm === '' || index === searchTerm) {
        card.parentElement.style.display = '';
      } else {
        card.parentElement.style.display = 'none';
      }
    });
  });

  document.addEventListener('click', function (e) {
    const btn = e.target.closest('.connect-btn');
    if (!btn) return;

    const url = btn.dataset.url;
    if (!url.startsWith('tg://proxy?')) {
      alert("❌ لینک پروکسی نامعتبر است.");
      return;
    }

    btn.innerText = "در حال اتصال...";
    btn.disabled = true;

    setTimeout(() => {
      window.location.href = url;
    }, 300);
  });
</script>

</body>
</html>
